


לא צריך את תקיית פבליק בשרת נואדגייאס כי כעת הפרונט אנד שלנו הוא הריאקט :

תיקיה חדשה: nodejsserver
בטרמינל אכונן על הנתיב של התיקיה הזאת עי כתיבה של cd
npm init -y
ואז לעשות התקנות של כל הפאקאגים : npm i express cors knex pg 
npm i nodemon --save-dev
לשנות בקובץ ל "start" : "nodemon server.js"
יצירת קובץ בתיקיה server.js
תיקיה חדשה בשם מודולס ובתוכה יהיה קובץ בשם db.js 
שם נשים את השורות של קנקס וכל מה שמחבר אותנו לדאטא בייס
ושפ נעשה פונקציה של גטקאנטריז שהיא מחזירה את כל המדינות 
וכדי להשתמש בפונקציה נכניס אותה לתוך אקספורט
בקובץ סרוור נעשה ריקוואייר ל:
אקספרס..קוארס..דיבי
נעשה איתחולים ל: אקספרס..קורס..
ליסאן לפורט ששונה מ 3000
נפתח דלת לגט ריקוואסט : app.get ('/getCountries...
res.send('ok')
ולבדיקה שהשרת עובד רק נרשום את הרוט הזה בדפדפן ונראה שמקבל תשובה
אחרי שעובר את הבדיקה נמחק את השורה הזאת ובמקום נשתמש בפונקציה של גט קאנטריס מתוך מודול דיבי DB.getCountries
.then(countries => {
res.send(countries)
})
.catch(e=> res.send({message : e})) משתמשים באובייקט כי מקבלים את התשובה כגייסון
ונראה שמקבל את כולם בדפדפן

ועכשיו עם אותו api : localhost:5000/getCountries 
בצד של ריאקט מבצעים לו פאץ ע"י פאץ או ע"י אקיוס כמו שראינו שאפשר לעשות וככה מקבלים את כל המדינות
וזה בעצם אייפיאי שאנחנו יצרנו בסרבר וכל קליינט שרוצה יכול לפנות אליו ולקבל ממנו מידע ע"י פאץ


נדאג לפתוח אצ פיגי אדמין



יהיו לי 2 טרמינלים פתוחים אחד לסרבר של הנודגייאס והשני לסרבר של ריאקט וכל אחד ירוץ בנתיב של התיקיה שלו עם אנפיאן סטארט

ועכשיו הסרבר מקשיב בפורט מסויים מחכה לבקשות והריאקט בסרבר משלו יבקש דברים 



ועכשיו בתיקיה של הריאקט :
בsrc נפתח תיקיה בשם components
ונםתח שם קובץ בשם דרופדאוון נקודה גייאס
ונעשה את זה קלאס קומפוננט כי פה נרצה לשים את כל הסטייאט והכל
אפשר לשים את הפרופס בתוך הפרמטר לקונסטרקטור ואז גם בתוך פרמט לסופררר או שלא ואז לבקש אותו עם נקודה דיס
ורק אם צריך את הפרופס אם לא אז נמחק אותו מהארגומנטים בקונסטרקטור ובסופרררר
ופה השאיר את הפרופס
בדיס נקודה סטייט בקונסטרקטור נרשום קנטריזליסט שזה יהיה מערך ריק
בראנדר נחזיר דיב שבתוכו יהיה סלאקט עם אופשיין אחד שיהיה כתוב בו פליז סלקט עם וואליו ריק

ובקובץ אפ דוט גייאס נשאיר אותו קומפוננט פונקציה ובריטארן נרשום דרופדאון
וכעת אראה את הסלקט שלי בדפדפן עם אופציה אחת בלבד
ורוצה שיהיו שם את כל הסיטיז שלי
את הפאצינג נשים בתוך פונקצ קומפוננט דיד מאונט כי רוצים שיהיה פאץ ישירות אחרי שטועים את העמוד ואז שם (אם נעשה פה פניה ל https אז יעשה בעיות לכן נכתוב בלי)
נעשה את הסאטסטייט שלתוכו נכניס את כל רשימת המדינות
והתשובה שמתקבלת מהפאץ זה עיר ואיידי עיר ואיידי
ולתוך סט סטייאט פשוט ארשום : קאנטריזליסט נקודותיים קאנטריז שזה התשובה שקיבלנו מהפאץ או אקסיוס

ואז מגיעים ישירות לראנדר אז מעל ריטארן נעשה דיסטרקטורינג :
const {countriesList} = this.state;
ולשורה של הסלקט והשורה של האופשיין אחריה נפתח סוגריים מסולסלים ובפנים נרשום
countries.map((item,i) => {

return <option key = {i} value={item.counter_id}>{item.country}</option>

})








חלק 2: כל פעם שנבחר ארץ נרצה שיופיע בדרופ דאוון הסיטיז שלה
קודם נלך לצד שרת וניצור שם פונקציה בדיבי getcities
const getCities = (id) => {

return db.select('citiy_id','city')
.from ('city')
.where({country_id : id}
.orderBy('city')

נוסיף את הפונקציה לאקספורט כדי שנוכל להשתמש בה

עכשיו נעבור לקובץ סרבר דוט גייאס ושם נפתח דלת לנתיב מתאים :
app.get('/getCities/:id',(req,res)=> {

DB.getCities(req.params.id)
.then....
.catch

ונעשה גם פה בדיקה שמבקלים את זה תקין בדפדפן

ואם מתקבל תקין אז נשנה את השורה הזאת ל:
res.send(cities)



עכשיו נעבור לפרונד אנד לריאקט שלנו :
פשוט בבחירת אוםציה של מדינה לבצע בקשת פאץ לאותו רוט של ערים בתוספת האיידי שילקח מהקאנטרי שעליה לחצנו באופשיין
וכדי לא לשכפל קוד של הסלקט גם עבור הערים ניצור פונקציה בקומפוננט שכבר יצרנו בשם :
renderDropDown = (array) => {

if(array.length === 0)
return null;
else
return .. יחזיר משהו שאנחנו הולכים לעשות לו ראנדר
{

ונכנסי לפה את כל הסלאקט שעשינו קודם
בלי הדיב שעטף אותה
ובמקום לעשות ללואה על קאנטריז נעשה אותה על אראיי
ובמקום הסלאקט שהיה בהתחלה בתוך ראנדר פשוט נרשום this.renderDropDown(countriesList)

}

}





}



וכעת כדישיהיה איוונט בכל בחירה של מידנה נוסיף איווט לסלאקט
onChange={this.handleSelect}

וניצור את הפונקציה הזאת בתוך המחלקת קומפוננט שלנו:
handleSelect = event => {
זה יתן את האיידי ונעשה פה פאץ שוב לאייפי אי שלנו שפתחנו בשרת
event.target.value

ובתשובה שאני מקבל שם בתוך ה then שזה בעצם מערך של ערים
נצטרך להכניס אותו לתוך הדרופ דאון של הערים
אז נעשה זאת ע"י :
נפתח משתנה חדש בסטאייט : citiesList : []
ואז נעשה פה סאטסטייט עם התשובה שקיבלנו מהפאץ לתוך המשתנה בסטאייט
ואז אוטומטית ניגש לראנדר
מה שאומר שבראנדר עכשיו 
נשנה את השורה של הדיסטרקטוינג ל:
const {countriesList, citiesList} = this.state

ונשכפל את השורה בתוך הריטארן :
{

this.renderDropDown רק שנרשום פה את הסיטיז

}

ויהיו שני בלוקים כאלה שבכל אחד מהם פונים לפונקציה


סיימתי ב 2:30

ובתוך הפונקצית עזר לבניית הסאלקט בכל פעם שיש סוגריים מסולסלים נרשום || ואת הערך של הסיטיי 

ובעצם יש כרגע איוונט גם על הסיטיז אז כדי לבטל אותו מה שנעשה ניצור ארגומנט לפונקציה שיוצרת את הסאלקט
נקרא לו סאלקטניים ואז לסלקט נוסיף אטריביוט בשם name={selectname} 
ושקורא לפונקמיה הזאת אוסיף משתנה ששולח פעם 'cities' ופעם ,בםומארןקד,
ונפתח את הפונקציה שיוצרת את הסלאקט ב:
if(event.target.name === "cities")
return